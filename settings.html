<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ayarlar • Yanlik v2</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="app" style="grid-template-columns:1fr;">
    <section class="main">
      <header class="topbar">
        <div class="title"><h1>Ayarlar</h1></div>
        <div class="actions"><a class="btn ghost" href="./index.html">Sohbete dön</a></div>
      </header>
      <div class="card" style="margin:16px; padding:16px;">
        <div class="grid">
          <label class="field"><span>Tema</span>
            <select id="theme"><option value="system">Sistem</option><option value="light">Açık</option><option value="dark">Koyu</option></select>
          </label>
          <label class="field"><span>Dil</span>
            <select id="language"><option value="tr">Türkçe</option><option value="en">English</option><option value="de">Deutsch</option></select>
          </label>
          <label class="field switch"><input id="memory" type="checkbox"/><span>Konuşmaları hatırla</span></label>
          <label class="field switch"><input id="typingIndicator" type="checkbox"/><span>Yazma göstergesi</span></label>
          <label class="field switch"><input id="sendSound" type="checkbox"/><span>Gönderme sesi</span></label>
          <label class="field"><span>Gönderme</span>
            <select id="sendBehavior"><option value="enter">Enter → Gönder</option><option value="ctrlenter">Ctrl+Enter → Gönder</option></select>
          </label>
          <label class="field"><span>Yaratıcılık (0–1)</span><input id="temperature" type="range" min="0" max="1" step="0.05"/></label>
          <label class="field"><span>Sistem mesajı</span><textarea id="systemPrompt" rows="3"></textarea></label>
        </div>
        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px;">
          <button id="resetBtn" class="btn ghost">Varsayılan</button>
          <button id="saveBtn" class="btn primary">Kaydet</button>
        </div>
      </div>
    </section>
  </div>

  <script src="./state.js"></script>
  <script>
    const $=s=>document.querySelector(s);
    const el={theme:$("#theme"),language:$("#language"),memory:$("#memory"),typingIndicator:$("#typingIndicator"),sendSound:$("#sendSound"),sendBehavior:$("#sendBehavior"),temperature:$("#temperature"),systemPrompt:$("#systemPrompt"),saveBtn:$("#saveBtn"),resetBtn:$("#resetBtn")};
    const DEF=window.__yanlik.DEFAULTS;
    function fill(){
      const s=window.__yanlik.getSettings();
      el.theme.value=s.theme; el.language.value=s.language; el.memory.checked=s.memory;
      el.typingIndicator.checked=s.typingIndicator; el.sendSound.checked=s.sendSound;
      el.sendBehavior.value=s.sendBehavior; el.temperature.value=String(s.temperature);
      el.systemPrompt.value=s.systemPrompt||"";
    }
    function save(){
      const next={ theme:el.theme.value, language:el.language.value, memory:el.memory.checked, typingIndicator:el.typingIndicator.checked, sendSound:el.sendSound.checked, sendBehavior:el.sendBehavior.value, temperature:Number(el.temperature.value), systemPrompt:el.systemPrompt.value.trim() };
      window.__yanlik.setSettings(next);
      alert("Kaydedildi.");
    }
    function reset(){ window.__yanlik.setSettings(DEF); fill(); alert("Varsayılanlara dönüldü."); }
    fill(); el.saveBtn.addEventListener("click",save); el.resetBtn.addEventListener("click",reset);
  </script>
</body>
</html>