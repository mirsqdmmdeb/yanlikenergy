<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Yanlik ‚Ä¢ Sohbet</title>
  <link rel="stylesheet" href="./style.css?v=ui4" />
  <script>
    // Tema y√ºkle
    try {
      const s = JSON.parse(localStorage.getItem("yanlik.settings")) || {};
      document.documentElement.setAttribute("data-theme", s.theme || "neon-blue");
    } catch {
      document.documentElement.setAttribute("data-theme", "neon-blue");
    }
  </script>
</head>
<body>
<script src="./auth.js"></script>
<script>
  const wait = setInterval(()=>{
    if(window.YANLIK_AUTH){
      clearInterval(wait);
      // index: misafir serbestse allowGuest:true
      const s = YANLIK_AUTH.requireAuth('./login.html', { allowGuest:true });
      if(!s) document.write("Y√∂nlendiriliyorsunuz...");
      // idle auto-logout (√∂neri)
      let last = Date.now();
      ['click','keydown','mousemove','touchstart'].forEach(ev=>document.addEventListener(ev,()=>last=Date.now()));
      setInterval(()=>{ if(Date.now()-last>30*60*1000){ YANLIK_AUTH.logout('login.html'); } }, 15000); // 30 dk idle
      setInterval(()=>{ try{ YANLIK_AUTH.pingSession(); }catch{} }, 10000);
    }
  },50);
</script>
<!-- üí° Login kontrol√º (sohbetten √∂nce √ßalƒ±≈ümalƒ±) -->
<script src="./auth.js"></script>
<script>
  const sess = YANLIK_AUTH.requireAuth('./login.html');
  if(!sess) document.write("Y√∂nlendiriliyorsunuz...");
</script>
  <div class="app">
    <!-- Kenar -->
    <aside class="sidebar">
      <div class="brand">
        <div class="dot"></div>
        <strong>YANLIK</strong>
        <span class="badge">v5.0</span>
      </div>
      <div class="search">
        <input type="search" placeholder="Ara..." />
      </div>
      <div class="threads">
        <div class="thread">
          <span class="name">Genel Chat</span>
          <span class="mini">Aktif</span>
        </div>
      </div>
    </aside>

    <!-- Ana -->
    <section class="main">
      <div class="topbar">
        <div class="title">
          <h2 id="threadTitle">Sohbet</h2>
          <span class="pill" id="statusPill">Hazƒ±r</span>
        </div>
        <div class="btn-group">
          <button class="btn ghost tooltip" data-tip="Ayarlar" onclick="location.href='settings.html'">‚öôÔ∏è</button>
        </div>
      </div>

      <div class="tabs">
        <div class="tab active"><span class="name">Chat</span></div>
        <div class="tab add" onclick="UI.toast('Yeni sekme yakƒ±nda‚Ä¶','success')">Ôºã</div>
      </div>

      <div class="chat" id="chatList" style="aspect-ratio:12/8;max-height:80vh;margin:auto;"></div>
      <div class="typing" id="typing" style="display:none;">Yanƒ±t hazƒ±rlanƒ±yor...</div>

      <div class="composer">
        <textarea id="messageInput" placeholder="Mesaj yaz..."></textarea>
        <div class="composer-actions">
          <span class="hint">Enter ‚Üí G√∂nder</span>
          <button id="sendBtn" class="btn primary">G√∂nder</button>
        </div>
      </div>
    </section>
  </div>

  <!-- Script sƒ±rasƒ± -->
  <script src="./ui.js?v=ui4"></script>
  <script src="./chat_core.js"></script>
  <script src="./chat_lang.js"></script>
  <script src="./chat_smalltalk.js"></script>       <!-- normal sohbet (yeni) -->
  <script src="./chat_empathetic.js"></script>      <!-- empati (geli≈ümi≈ü yeni) -->
  <script src="./chat_crisis.js"></script>
  <script src="./chat_ui.js"></script>
  <script src="./chat_boot.js"></script>
</body>
</html>